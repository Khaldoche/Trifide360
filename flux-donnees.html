<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Flux de DonnÃ©es - Trifide 360</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="container">
        <nav class="sidebar">
            <div class="logo">
                <h1>Trifide 360</h1>
                <p>Documentation Architecture</p>
            </div>
            
            <input type="text" class="search-box" placeholder="Rechercher..." id="searchBox">
            
            <ul class="nav-menu">
                <li class="nav-item">
                    <a href="index.html" class="nav-link">ğŸ  Accueil</a>
                </li>
                <li class="nav-item">
                    <a href="vue-ensemble.html" class="nav-link">Vue d'Ensemble</a>
                </li>
                <li class="nav-item">
                    <a href="fonctionnalites-metier.html" class="nav-link">FonctionnalitÃ©s MÃ©tier</a>
                    <ul class="nav-submenu">
                        <li><a href="donnees-geospatiales.html" class="nav-link">DonnÃ©es GÃ©ospatiales</a></li>
                        <li><a href="visualisation-2d-3d.html" class="nav-link">Visualisation 2D/3D</a></li>
                        <li><a href="creation-interactive.html" class="nav-link">CrÃ©ation Interactive</a></li>
                    </ul>
                </li>
                <li class="nav-item">
                    <a href="structure-code.html" class="nav-link">Structure du Code</a>
                </li>
                <li class="nav-item">
                    <a href="mapping-fonctions-code.html" class="nav-link">Mapping Fonctions â†” Code</a>
                </li>
                <li class="nav-item">
                    <a href="flux-donnees.html" class="nav-link active">Flux de DonnÃ©es</a>
                </li>
                <li class="nav-item">
                    <a href="hierarchie-classes.html" class="nav-link">HiÃ©rarchie des Classes</a>
                </li>
                <li class="nav-item">
                    <a href="communication-inter-modules.html" class="nav-link">Communication Inter-Modules</a>
                </li>
                <li class="nav-item">
                    <a href="catalogue-methodes.html" class="nav-link">Catalogue des MÃ©thodes</a>
                </li>
                <li class="nav-item">
                    <a href="patterns-anti-patterns.html" class="nav-link">Patterns & Anti-Patterns</a>
                </li>
                <li class="nav-item">
                    <a href="recommandations.html" class="nav-link">Recommandations</a>
                </li>
            </ul>
        </nav>

        <main class="main-content">
            <section class="section active">
                <h1>ğŸŒŠ Architecture des Flux de DonnÃ©es</h1>
                
                <div class="card">
                    <h2>Vue d'Ensemble de l'Architecture</h2>
                    <p>Trifide 360 implÃ©mente une architecture de flux de donnÃ©es multi-niveaux optimisÃ©e pour les performances et la scalabilitÃ© des donnÃ©es gÃ©ospatiales volumineuses. L'architecture privilÃ©gie le streaming temps rÃ©el et la minimisation des transferts de donnÃ©es.</p>
                    
                    <div class="tech-stack">
                        <div class="tech-item">
                            <h4>ğŸ“¥ Ingestion</h4>
                            <p>Readers spÃ©cialisÃ©s multi-formats</p>
                        </div>
                        <div class="tech-item">
                            <h4>ğŸ”„ Transformation</h4>
                            <p>Pipeline de traitement et validation</p>
                        </div>
                        <div class="tech-item">
                            <h4>ğŸ’¾ Stockage</h4>
                            <p>FeatureTables ArcGIS en mÃ©moire</p>
                        </div>
                        <div class="tech-item">
                            <h4>ğŸ¨ Rendu</h4>
                            <p>Graphics Overlays haute performance</p>
                        </div>
                        <div class="tech-item">
                            <h4>ğŸŒ Distribution</h4>
                            <p>IPC vers Unity 3D temps rÃ©el</p>
                        </div>
                        <div class="tech-item">
                            <h4>ğŸ“¤ Export</h4>
                            <p>Writers universels multi-destinations</p>
                        </div>
                    </div>
                </div>

                <div class="card">
                    <h2>Pipeline Principal de Chargement</h2>
                    
                    <div class="flow-diagram">
                        <h3>Flux Complet d'Import de DonnÃ©es</h3>
                        <div class="code-block">
ğŸ“ Fichier Source (SHP, LAS, CSV, MX, E57)
    â†“
ğŸ” File Format Detection & Validation
    â†“
ğŸ“– Specialized Reader Selection (ShapeFileReader, LASReader, etc.)
    â†“
âš¡ Parallel Data Parsing & Stream Processing
    â†“
âœ… Geometry & Attribute Validation Engine
    â†“ (Invalid data â†’ Error Log + User Notification)
    â†“
ğŸ”„ Coordinate System Transformation (if needed)
    â†“
ğŸ—ï¸ GISMind Geometry Object Creation
    â†“
ğŸ“Š ArcGIS FeatureTable Population
    â†“
ğŸ¨ Renderer & Symbology Application
    â†“
ğŸ—ºï¸ Graphics Overlay Creation & GPU Upload
    â†“
ğŸ–¥ï¸ Map Display Refresh
    â†“
ğŸ’¾ Optional Project Persistence
                        </div>
                    </div>

                    <div class="features-grid">
                        <div class="feature-card">
                            <h4>ğŸš€ Optimisations Performance</h4>
                            <ul>
                                <li><strong>Parsing parallÃ¨le :</strong> Multi-threading pour gros fichiers</li>
                                <li><strong>Streaming progressif :</strong> Affichage incrÃ©mental</li>
                                <li><strong>Memory pooling :</strong> RÃ©utilisation objets gÃ©omÃ©triques</li>
                                <li><strong>Lazy loading :</strong> Chargement Ã  la demande</li>
                                <li><strong>Cache intelligent :</strong> DonnÃ©es frÃ©quemment accÃ©dÃ©es</li>
                            </ul>
                        </div>
                        <div class="feature-card">
                            <h4>ğŸ”’ ContrÃ´les QualitÃ©</h4>
                            <ul>
                                <li><strong>Validation format :</strong> Structure fichier correcte</li>
                                <li><strong>GÃ©omÃ©trie valide :</strong> Topologie et contraintes</li>
                                <li><strong>Attributs cohÃ©rents :</strong> Types et domaines</li>
                                <li><strong>Projection valide :</strong> SystÃ¨me de rÃ©fÃ©rence</li>
                                <li><strong>Limites spatiales :</strong> Ã‰tendue gÃ©ographique</li>
                            </ul>
                        </div>
                    </div>
                </div>

                <div class="card">
                    <h2>Pipeline d'Ã‰dition Interactive</h2>
                    
                    <div class="flow-diagram">
                        <h3>Flux de CrÃ©ation/Modification d'EntitÃ©s</h3>
                        <div class="code-block">
ğŸ‘† User Input (Mouse/Keyboard/Touch)
    â†“
ğŸ¯ Input Event Capture (MapView Events)
    â†“
ğŸ“ Coordinate Conversion (Screen â†’ Map â†’ Data)
    â†“
ğŸ§² Snapping Engine Application (if enabled)
    â†“
âœ… Real-time Geometry Validation
    â†“ (Invalid â†’ Visual Feedback + Error Message)
    â†“
ğŸ¨ Temporary Graphics Display (Rubber Band Effect)
    â†“
ğŸ“ Attribute Form Presentation (if required)
    â†“
ğŸ—ï¸ Feature Creation/Modification
    â†“
ğŸ“Š FeatureTable Update (Add/Update/Delete)
    â†“
ğŸ—ºï¸ Graphics Overlay Refresh
    â†“
ğŸ’¾ Undo/Redo Stack Management
    â†“
ğŸ”„ Unity 3D Synchronization (if active)
    â†“
ğŸ’¿ Auto-save (background thread)
                        </div>
                    </div>

                    <div class="pattern-card">
                        <h4>âš¡ Optimisations Temps RÃ©el</h4>
                        <ul>
                            <li><strong>Validation asynchrone :</strong> Non-bloquante pour l'utilisateur</li>
                            <li><strong>Feedback immÃ©diat :</strong> Indicateurs visuels instantanÃ©s</li>
                            <li><strong>Batch operations :</strong> Groupement modifications multiples</li>
                            <li><strong>Selective refresh :</strong> Mise Ã  jour zones modifiÃ©es uniquement</li>
                            <li><strong>Transaction management :</strong> OpÃ©rations atomiques</li>
                        </ul>
                    </div>
                </div>

                <div class="card">
                    <h2>Communication Inter-Processus (WPF â†” Unity)</h2>
                    
                    <div class="flow-diagram">
                        <h3>Architecture Dual-Channel Haute Performance</h3>
                        <div class="code-block">
ğŸ–¥ï¸ WPF Main Process                    ğŸ® Unity 3D Process
        â†“                                        â†‘
ğŸŒ TCP Socket Client  â†”â†” COMMANDS â†”â†”  TCP Socket Server
        â†“                                        â†‘
ğŸ“¡ Command Queue              â†”â†”              Command Processor
        â†“                                        â†‘
ğŸ’¾ Memory-Mapped Files â†”â†” DATA (60FPS) â†”â†”  Shared Memory Reader
        â†“                                        â†‘
ğŸ—‚ï¸ Serialized Data                              Data Deserializer
        â†“                                        â†‘
ğŸ”„ Background Thread            â†”â†”              Unity Main Thread

ğŸ“Š Data Types Transferred:
   â€¢ Camera Positions & Orientations (16ms intervals)
   â€¢ Geometric Objects (Points, Lines, Polygons)  
   â€¢ Transformation Matrices (4x4 double precision)
   â€¢ Selection States & Highlighting Info
   â€¢ GPS Trajectories & Real-time Positions
                        </div>
                    </div>

                    <div class="features-grid">
                        <div class="feature-card">
                            <h4>ğŸš€ Canal TCP - Commandes</h4>
                            <ul>
                                <li><strong>Port :</strong> 8888 (configurable)</li>
                                <li><strong>Protocole :</strong> JSON over TCP</li>
                                <li><strong>Commandes :</strong> MOVE_CAMERA, SELECT_OBJECT, ADD_GEOMETRY</li>
                                <li><strong>Latence :</strong> < 5ms local</li>
                                <li><strong>FiabilitÃ© :</strong> TCP garantit livraison</li>
                            </ul>
                        </div>
                        <div class="feature-card">
                            <h4>ğŸ’¾ Memory-Mapped Files - DonnÃ©es</h4>
                            <ul>
                                <li><strong>Taille :</strong> 64MB buffer circulaire</li>
                                <li><strong>FrÃ©quence :</strong> 60 FPS (16.7ms)</li>
                                <li><strong>Format :</strong> Binary serialization optimisÃ©e</li>
                                <li><strong>Synchronisation :</strong> Mutex + Ã©vÃ©nements</li>
                                <li><strong>Compression :</strong> LZ4 temps rÃ©el</li>
                            </ul>
                        </div>
                    </div>
                </div>

                <div class="card">
                    <h2>Gestion des DonnÃ©es Volumineuses (LiDAR)</h2>
                    
                    <div class="flow-diagram">
                        <h3>Pipeline Traitement Nuages de Points Massifs</h3>
                        <div class="code-block">
ğŸ“ Large Point Cloud File (LAS/LAZ - GB size)
    â†“
ğŸ” File Header Analysis + Spatial Index Reading
    â†“
ğŸ“Š Point Density Calculation + LOD Planning
    â†“
âš¡ Chunked Loading Strategy (Spatial Tiles)
    â†“
ğŸ¯ Viewport-based Culling + Distance LOD
    â†“
ğŸ”„ Background Streaming (Multiple Threads)
    â†“
ğŸ’¾ GPU Memory Management (VRAM Buffer Pool)
    â†“
ğŸ¨ Shader-based Rendering (Point Sprites + Instancing)
    â†“
ğŸ–¥ï¸ Real-time Display (Millions of Points @ 60fps)
    â†“
â™»ï¸ Memory Cleanup (LRU Cache Eviction)

Optimizations Applied:
â€¢ Octree Spatial Indexing for fast queries
â€¢ Frustum Culling eliminates off-screen points  
â€¢ Level-of-Detail reduces distant point density
â€¢ GPU Compute Shaders for parallel processing
â€¢ Asynchronous I/O prevents UI blocking
                        </div>
                    </div>

                    <div class="recommendation-card">
                        <h4>ğŸ“ˆ MÃ©triques de Performance Typiques</h4>
                        <ul>
                            <li><strong>Chargement initial :</strong> 50M points en ~3 secondes</li>
                            <li><strong>Streaming :</strong> 10M points/seconde en arriÃ¨re-plan</li>
                            <li><strong>MÃ©moire GPU :</strong> 2GB pour 100M points affichÃ©s</li>
                            <li><strong>Frame rate :</strong> 60 FPS maintenu avec 500M+ points</li>
                            <li><strong>Latence interaction :</strong> < 16ms pour sÃ©lection/zoom</li>
                        </ul>
                    </div>
                </div>

                <div class="card">
                    <h2>Pipeline d'Export et Persistance</h2>
                    
                    <div class="flow-diagram">
                        <h3>Flux de Sauvegarde Projet et Export DonnÃ©es</h3>
                        <div class="code-block">
ğŸ“Š Active Project State (FeatureTables + UI State + Settings)
    â†“
ğŸ” Export Format Selection (Shapefile, CSV, KML, Project Archive)
    â†“
âš™ï¸ Data Preparation & Coordinate Transformation
    â†“
ğŸ—‚ï¸ Serialization Process (Binary + XML Metadata)
    â†“
ğŸ“ File Generation (Parallel for multiple outputs)
    â†“
âœ… Output Validation & Integrity Check
    â†“
ğŸ’¾ File System Write (Atomic operations)
    â†“
ğŸ“‹ Export Report Generation
    â†“
ğŸ”„ Background Backup Creation (if enabled)

Project Archive Contents:
ğŸ“¦ project.trf3d
 â”œâ”€â”€ ğŸ“„ metadata.xml (Project info + timestamps)
 â”œâ”€â”€ ğŸ“ data/ (All FeatureTables as binary)
 â”œâ”€â”€ ğŸ“ symbology/ (Renderer configurations)
 â”œâ”€â”€ ğŸ“ settings/ (UI layout + user preferences)
 â””â”€â”€ ğŸ“ cache/ (Temporary data + thumbnails)
                        </div>
                    </div>
                </div>

                <div class="card">
                    <h2>Gestion MÃ©moire et Cache</h2>
                    
                    <div class="features-grid">
                        <div class="feature-card">
                            <h4>ğŸ’¾ StratÃ©gie de Cache Multi-Niveaux</h4>
                            <ul>
                                <li><strong>L1 - RAM Cache :</strong> GÃ©omÃ©tries actives (512MB)</li>
                                <li><strong>L2 - Disk Cache :</strong> Fichiers traitÃ©s (2GB)</li>
                                <li><strong>L3 - GPU Cache :</strong> Textures et vertex buffers</li>
                                <li><strong>Ã‰viction LRU :</strong> Moins rÃ©cemment utilisÃ©es</li>
                                <li><strong>PrÃ©diction :</strong> PrÃ©chargement donnÃ©es probables</li>
                            </ul>
                        </div>
                        <div class="feature-card">
                            <h4>ğŸ—‘ï¸ Garbage Collection Optimization</h4>
                            <ul>
                                <li><strong>Object pooling :</strong> RÃ©utilisation Geometry objects</li>
                                <li><strong>String interning :</strong> Attributs texte dÃ©dupliquÃ©s</li>
                                <li><strong>Event unsubscription :</strong> PrÃ©vention memory leaks</li>
                                <li><strong>Large object heap :</strong> Ã‰vitement fragmentation</li>
                                <li><strong>GC monitoring :</strong> MÃ©triques temps rÃ©el</li>
                            </ul>
                        </div>
                        <div class="feature-card">
                            <h4>ğŸ“Š Monitoring des Ressources</h4>
                            <ul>
                                <li><strong>Memory usage :</strong> RAM + GPU tracking</li>
                                <li><strong>I/O statistics :</strong> Lecture/Ã©criture fichiers</li>
                                <li><strong>Network traffic :</strong> Communication Unity</li>
                                <li><strong>Thread utilization :</strong> CPU cores usage</li>
                                <li><strong>Performance counters :</strong> MÃ©triques Windows</li>
                            </ul>
                        </div>
                        <div class="feature-card">
                            <h4>âš ï¸ Gestion Situations Critiques</h4>
                            <ul>
                                <li><strong>Memory pressure :</strong> LibÃ©ration automatique cache</li>
                                <li><strong>Disk space low :</strong> Nettoyage fichiers temporaires</li>
                                <li><strong>GPU overload :</strong> RÃ©duction qualitÃ© rendu</li>
                                <li><strong>Thread deadlock :</strong> DÃ©tection et rÃ©cupÃ©ration</li>
                                <li><strong>Unity disconnect :</strong> Mode dÃ©gradÃ© 2D uniquement</li>
                            </ul>
                        </div>
                    </div>
                </div>

                <div class="card">
                    <h2>Patterns d'Architecture AppliquÃ©s</h2>
                    
                    <div class="features-grid">
                        <div class="feature-card">
                            <h4>ğŸ—ï¸ Producer-Consumer</h4>
                            <ul>
                                <li><strong>File readers :</strong> Producteurs de donnÃ©es</li>
                                <li><strong>Rendering engine :</strong> Consommateur affichage</li>
                                <li><strong>Thread-safe queues :</strong> Communication async</li>
                                <li><strong>Backpressure handling :</strong> Gestion surcharge</li>
                            </ul>
                        </div>
                        <div class="feature-card">
                            <h4>ğŸ”„ Pipeline Pattern</h4>
                            <ul>
                                <li><strong>Ã‰tapes sÃ©quentielles :</strong> Parse â†’ Validate â†’ Transform â†’ Display</li>
                                <li><strong>Filtres configurables :</strong> Ajout/suppression Ã©tapes</li>
                                <li><strong>ParallÃ©lisation :</strong> Ã‰tapes indÃ©pendantes simultanÃ©es</li>
                                <li><strong>Error handling :</strong> Gestion Ã©checs par Ã©tape</li>
                            </ul>
                        </div>
                        <div class="feature-card">
                            <h4>ğŸ“¡ Publish-Subscribe</h4>
                            <ul>
                                <li><strong>Data change events :</strong> Notifications modifications</li>
                                <li><strong>UI updates :</strong> Abonnements composants interface</li>
                                <li><strong>Unity synchronization :</strong> Ã‰vÃ©nements inter-processus</li>
                                <li><strong>Loose coupling :</strong> Modules indÃ©pendants</li>
                            </ul>
                        </div>
                        <div class="feature-card">
                            <h4>ğŸ¯ Command Pattern</h4>
                            <ul>
                                <li><strong>Undo/Redo :</strong> Historique opÃ©rations rÃ©versibles</li>
                                <li><strong>Unity commands :</strong> Messages inter-processus</li>
                                <li><strong>Batch operations :</strong> Groupement commandes</li>
                                <li><strong>Transaction logs :</strong> Audit trail complet</li>
                            </ul>
                        </div>
                    </div>
                </div>

                <div class="card">
                    <h2>ğŸ”— Navigation</h2>
                    <div class="features-grid">
                        <div class="feature-card">
                            <h4><a href="mapping-fonctions-code.html">â¬…ï¸ Mapping Fonctions â†” Code</a></h4>
                            <p>Correspondances dÃ©taillÃ©es</p>
                        </div>
                        <div class="feature-card">
                            <h4><a href="hierarchie-classes.html">â¡ï¸ HiÃ©rarchie des Classes</a></h4>
                            <p>Organisation orientÃ©e objet</p>
                        </div>
                        <div class="feature-card">
                            <h4><a href="communication-inter-modules.html">â¡ï¸ Communication Inter-Modules</a></h4>
                            <p>Architecture IPC dÃ©taillÃ©e</p>
                        </div>
                        <div class="feature-card">
                            <h4><a href="structure-code.html">â¬…ï¸ Structure du Code</a></h4>
                            <p>Organisation fichiers source</p>
                        </div>
                    </div>
                </div>
            </section>
        </main>
    </div>
</body>
</html>